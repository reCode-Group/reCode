<!DOCTYPE html>
<html lang="ru"
      xmlns:th="http://www.thymeleaf.org" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>reCode.ru - Онлайн конвертер VBA макросов и JS скриптов</title>
    <link rel="icon" th:href="@{/img/favicon.ico}" sizes="16x16">
    <link rel="icon" th:href="@{/img/favicon.svg}" type="image/svg+xml">
    <link th:href="@{/css/main.css}" rel="stylesheet" type="text/css">
    <link th:href="@{/css/ws.css}" rel="stylesheet" type="text/css">
    <script th:src="@{/js/app.js}"></script>
    <link rel="preload" th:href="@{/css/fonts.css}" as="style">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" th:href="@{codemirror/lib/codemirror.css}">
    <script th:src="@{/codemirror/lib/codemirror.js}"></script>
    <script th:src="@{/codemirror/mode/javascript/javascript.js}"></script>
    <script th:src="@{/codemirror/mode/vb/vb.js}"></script>
</head>
<body>
    <header class="layout-header">
        <div class="header-top">
            <a class="m-l logo" th:href="@{/}">
                <img style="width: 9rem" src="/img/logo.png" alt="reCode">
            </a>
            <div class="search">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M17.0392 15.6244C18.2714 14.084 19.0082 12.1301 19.0082 10.0041C19.0082 5.03127 14.9769 1 10.0041 1C5.03127 1 1 5.03127 1 10.0041C1 14.9769 5.03127 19.0082 10.0041 19.0082C12.1301 19.0082 14.084 18.2714 15.6244 17.0392L21.2921 22.707C21.6828 23.0977 22.3163 23.0977 22.707 22.707C23.0977 22.3163 23.0977 21.6828 22.707 21.2921L17.0392 15.6244ZM10.0041 17.0173C6.1308 17.0173 2.99087 13.8774 2.99087 10.0041C2.99087 6.1308 6.1308 2.99087 10.0041 2.99087C13.8774 2.99087 17.0173 6.1308 17.0173 10.0041C17.0173 13.8774 13.8774 17.0173 10.0041 17.0173Z" fill="#0F0F0F"/>
                </svg>
                Поиск
            </div>
            <div class="auth" style="margin-left: auto">
                <a class="button-link" th:if="${not #authorization.expression('isAuthenticated()')}" th:href="@{/registration}">Зарегистрироваться</a>
                <a class="button-link o-button m-r" th:if="${not #authorization.expression('isAuthenticated()')}" th:href="@{/login}">Войти
                    <svg width="14" height="14" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M20,21V3H13a1,1,0,0,1,0-2h8a1,1,0,0,1,1,1V22a1,1,0,0,1-1,1H13a1,1,0,0,1,0-2ZM2,12a1,1,0,0,0,1,1H14.586l-2.293,2.293a1,1,0,1,0,1.414,1.414l4-4a1,1,0,0,0,0-1.414l-4-4a1,1,0,1,0-1.414,1.414L14.586,11H3A1,1,0,0,0,2,12Z"/>
                    </svg>
                </a>
                <p sec:authorize="isAuthenticated()"><span th:text="${#authentication.name}"></span></p>
                <a class="button-link o-button m-r" sec:authorize="isAuthenticated()" th:href="@{/logout}">Выйти</a>
            </div>show-button">
                <svg width="1.8rem" height="1.8rem" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <use xlink:href="#show"></use>
                </svg>
            </a>
            <div class="burger-menu">
                <div class="nav-auth">
                    <a class="button-link" th:href="@{/registration}">Зарегистрироваться</a>
                    <a class="button-link l-button" th:href="@{/login}">Войти
                        <svg width="14" height="14" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M20,21V3H13a1,1,0,0,1,0-2h8a1,1,0,0,1,1,1V22a1,1,0,0,1-1,1H13a1,1,0,0,1,0-2ZM2,12a1,1,0,0,0,1,1H14.586l-2.293,2.293a1,1,0,1,0,1.414,1.414l4-4a1,1,0,0,0,0-1.414l-4-4a1,1,0,1,0-1.414,1.414L14.586,11H3A1,1,0,0,0,2,12Z"/>
                        </svg>
                    </a>
                </div>
                <div class="search"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M17.0392 15.6244C18.2714 14.084 19.0082 12.1301 19.0082 10.0041C19.0082 5.03127 14.9769 1 10.0041 1C5.03127 1 1 5.03127 1 10.0041C1 14.9769 5.03127 19.0082 10.0041 19.0082C12.1301 19.0082 14.084 18.2714 15.6244 17.0392L21.2921 22.707C21.6828 23.0977 22.3163 23.0977 22.707 22.707C23.0977 22.3163 23.0977 21.6828 22.707 21.2921L17.0392 15.6244ZM10.0041 17.0173C6.1308 17.0173 2.99087 13.8774 2.99087 10.0041C2.99087 6.1308 6.1308 2.99087 10.0041 2.99087C13.8774 2.99087 17.0173 6.1308 17.0173 10.0041C17.0173 13.8774 13.8774 17.0173 10.0041 17.0173Z" fill="#0F0F0F"/>
                </svg>
                    Поиск
                </div>
                <nav class="navbar">
                    <a class="nav-link" href="/#about">О стартапе</a>
                    <a class="nav-link" th:href="@{/workspace}">Демо-версия</a>
                    <a class="nav-link" th:href="@{/blank}">Мастерская макросов</a>
                    <a class="nav-link" href="/#partners">Партнеры</a>
                    <a class="nav-link" th:href="@{/documentation}">Ресурсы
                        <svg width="13" height="13" viewBox="0 -3 24 24" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.29297 6.70711C3.68349 6.31658 4.31666 6.31658 4.70718 6.70711L12.0001 14L19.293 6.70711C19.6835 6.31658 20.3167 6.31658 20.7072 6.70711L21.4143 7.41421C21.8048 7.80474 21.8048 8.4379 21.4143 8.82843L13.0607 17.182C12.4749 17.7678 11.5252 17.7678 10.9394 17.182L2.58586 8.82843C2.19534 8.4379 2.19534 7.80474 2.58586 7.41422L3.29297 6.70711Z"/></svg>
                    </a>
                    <a class="nav-link" th:href="@{/contacts}">Помощь</a>
                </nav>
            </div>
        </div>
        <div class="header-bottom">
            <nav class="m-l navbar">
                <a class="nav-link" href="/#about">О стартапе</a>
                <a class="nav-link" th:href="@{/workspace}">Демо-версия</a>
                <a class="nav-link" th:href="@{/blank}">Мастерская макросов</a>
                <a class="nav-link" href="/#partners">Партнеры</a>
                <a class="nav-link" th:href="@{/documentation}">Ресурсы
                    <svg width="13" height="13" viewBox="0 -3 24 24" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.29297 6.70711C3.68349 6.31658 4.31666 6.31658 4.70718 6.70711L12.0001 14L19.293 6.70711C19.6835 6.31658 20.3167 6.31658 20.7072 6.70711L21.4143 7.41421C21.8048 7.80474 21.8048 8.4379 21.4143 8.82843L13.0607 17.182C12.4749 17.7678 11.5252 17.7678 10.9394 17.182L2.58586 8.82843C2.19534 8.4379 2.19534 7.80474 2.58586 7.41422L3.29297 6.70711Z"/></svg>
                </a>
                <a class="nav-link" th:href="@{/contacts}">Помощь</a>
            </nav>
            <a class="button-link d-button m-l-auto m-r" href="/#quick-start">Подробнее</a>
        </div>
    </header>

    <main class="layout-main">
        <div class="menu-overlay" style="display: none; visibility: hidden;"></div>
        <div class="demo m-r m-l">
            <span class="section-heading">Демо-версия переводчика VBA макроса в JavaScript</span>
            <div class="converter-container">
                <div class="converter-left">
                    <div class="import-block">
                        <div class="drag-n-drop"><span>Перетащите или кликните чтобы открыть файл ...</span></div>
                        <button class="open-file button-link l-button"><i class="bi bi-folder2-open"></i>Открыть</button>
                    </div>
                    <div id="from" class="editor"></div>
                </div>
                <div class="converter-right">
                    <div class="export-block" style="justify-content: flex-end">
                        <button class="copy-btn button-link l-button" onclick="copyFunction()"><i class="bi bi-copy"></i>
                            Копировать
                        </button>
                    </div>
                    <div id="to" class="editor"></div>
                </div>
            </div>
            <button class="convert-button" onclick="sendData()">Преобразовать</button>
        </div>
    </main>

    <footer class="layout-footer" style="padding: 1vw 0">
        <div class="footer-wrapper m-l m-r">
            <div class="footer-bottom">
                <div class="footer-left">
                    <ul class="footer-links">
                        <li class="footer-link"><a href="/#team">О команде</a></li>
                        <li class="footer-link"><a th:href="@{/documentation}">Юридические документы</a></li>
                        <li class="footer-link"><a th:href="@{/contacts}">Контакты</a></li>
                        <li class="footer-link"><a target="_blank" href="https://t.me/recode_official">Блог</a></li>
                        <li class="footer-link"><a target="_blank" href="https://t.me/recode_official">Новости</a></li>
                        <li class="footer-link"><a target="_blank" href="https://vk.com/recode_official">Мы Вконтакте</a></li>
                        <li class="footer-link"><a th:href="@{/blank}">Другие проекты</a></li>
                        <li class="footer-link"><a th:href="@{/contacts}">Помощь</a></li>
                    </ul>
                </div>
                <div class="footer-right">
                    <span class="footer-copyright">&copy 2024 ООО «РЕКОД»</span>
                    <div class="footer-social-buttons">
                        <a class="s-button" href="https://vk.com/recode_official">
                            <svg width="20" height="12" viewBox="0 0 14 8" xmlns="http://www.w3.org/2000/svg"><path d="M8.04837 7.29889C7.58706 7.29889 7.12575 7.29889 6.66444 7.29889C6.65226 7.29717 6.63945 7.29488 6.62728 7.29373C6.5427 7.28456 6.45749 7.27882 6.37291 7.26678C6.05897 7.22091 5.76296 7.12516 5.47913 6.9973C5.0364 6.7972 4.64557 6.53116 4.28229 6.23129C3.81072 5.8414 3.39747 5.40507 3.01817 4.94293C2.3608 4.14252 1.80851 3.28648 1.32798 2.39204C1.15051 2.06178 0.983922 1.72693 0.844248 1.38234C0.766722 1.18969 0.923696 0.992452 1.15243 0.991879C1.79121 0.991306 2.42936 0.991306 3.06814 0.991879C3.25139 0.991879 3.41092 1.08935 3.47948 1.24129C3.88825 2.14606 4.40915 2.99636 5.04281 3.79105C5.05882 3.81111 5.07548 3.83175 5.09534 3.84896C5.326 4.05021 5.71042 3.98599 5.84497 3.72396C5.87701 3.66204 5.88918 3.59725 5.88854 3.52902C5.87957 3.01815 5.87124 2.50671 5.86163 1.99584C5.85907 1.8439 5.83856 1.69482 5.77321 1.5532C5.6739 1.33876 5.49899 1.20689 5.23886 1.17421C5.18184 1.16676 5.12289 1.16848 5.06267 1.16561C5.06587 1.16102 5.06907 1.15643 5.07228 1.15242C5.27026 0.923075 5.52846 0.779161 5.84625 0.723544C5.91545 0.71093 5.98593 0.706917 6.05576 0.699463C6.07499 0.699463 6.09421 0.699463 6.11343 0.699463C6.1429 0.701183 6.17301 0.705197 6.20249 0.705197C6.72018 0.70577 7.23851 0.705197 7.7562 0.70577C7.79785 0.70577 7.8395 0.708063 7.8805 0.71437C8.23417 0.77228 8.47123 1.02857 8.47123 1.35081C8.47123 2.00845 8.47059 2.66553 8.47187 3.32318C8.47187 3.3851 8.47636 3.4476 8.48469 3.50895C8.49942 3.61044 8.53082 3.70733 8.60001 3.79105C8.66921 3.87533 8.76083 3.91776 8.87808 3.89138C8.93062 3.87934 8.98508 3.85928 9.02801 3.83061C9.09785 3.78474 9.16576 3.73314 9.22406 3.6758C9.39705 3.50723 9.52456 3.30999 9.64437 3.10931C10.0217 2.47919 10.3991 1.84906 10.7778 1.22008C10.8675 1.07158 11.011 0.993026 11.2 0.993026C11.9061 0.991306 12.6115 0.991879 13.3175 0.993026C13.3803 0.993026 13.4438 0.999333 13.5046 1.0108C13.6411 1.0366 13.7481 1.09852 13.7782 1.22925C13.7904 1.28028 13.7897 1.3359 13.7846 1.38865C13.7724 1.50103 13.7282 1.60538 13.677 1.70801C13.5469 1.96717 13.3714 2.20225 13.1811 2.42816C12.7281 2.96483 12.2732 3.50035 11.8196 4.03645C11.6267 4.26407 11.6447 4.58229 11.8644 4.7887C12.3027 5.20038 12.7428 5.61033 13.1824 6.02086C13.3131 6.14299 13.4489 6.26053 13.5764 6.38552C13.6879 6.49561 13.7699 6.62289 13.8051 6.77025C13.8513 6.96175 13.7673 7.12516 13.5713 7.21117C13.5034 7.24098 13.4277 7.25876 13.3541 7.27596C13.2977 7.28914 13.2387 7.29201 13.1811 7.29946C12.491 7.29946 11.801 7.29946 11.1116 7.29946C11.1058 7.29774 11.0994 7.29545 11.0936 7.29488C10.9412 7.27825 10.8098 7.22206 10.6977 7.1286C10.5638 7.01622 10.4299 6.90384 10.296 6.79089C9.95127 6.50134 9.60657 6.21122 9.26123 5.92167C9.1459 5.82534 9.00879 5.7875 8.85373 5.8133C8.625 5.85172 8.47059 6.02143 8.47059 6.23014C8.47059 6.44515 8.47123 6.66016 8.47059 6.87517C8.46995 7.06897 8.32515 7.23697 8.11628 7.28628C8.0945 7.29029 8.07143 7.2943 8.04837 7.29889Z"></path></svg>
                        </a>
                        <a class="s-button" href="https://t.me/recode_official">
                            <svg width="14" height="11" viewBox="0 0 12 10" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M5.02329 6.61127C5.14533 5.77138 11.5469 1.18715 10.0396 1.95185L5.97258 4.20759C3.56646 5.60791 3.74126 5.38477 4.25038 7.05146C4.29837 7.21249 4.49859 8.10474 4.65622 8.28587C4.93907 8.61068 5.01979 6.6344 5.02329 6.61127ZM2.77035 5.70502C3.00045 5.79208 2.95055 5.76255 3.02873 6.01796C3.2013 6.58174 3.38182 7.10169 3.55756 7.66121C4.15345 9.55834 4.08004 9.56899 4.92795 8.9081C6.32725 7.81737 6.19759 7.71052 7.00069 8.2536L9.31687 9.87158C9.97568 10.348 10.0103 9.38299 10.1235 8.86609L11.9798 0.385316C12.0208 0.220321 11.9966 0.118646 11.9327 0.0614151C11.7986 -0.0585255 11.4897 0.0178834 11.2418 0.114688L1.372 3.7607C-1.58551 4.82616 0.880037 4.99116 2.77035 5.70502Z"></path></svg>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
        <symbol id="show" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path d="M4 18L20 18" stroke="#000000" stroke-width="2" stroke-linecap="round"/>
            <path d="M4 12L20 12" stroke="#000000" stroke-width="2" stroke-linecap="round"/>
            <path d="M4 6L20 6" stroke="#000000" stroke-width="2" stroke-linecap="round"/>
        </symbol>
        <symbol id="hide" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path d="M6 6L18 18M18 6L6 18" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </symbol>
    </svg>

    <script>
        function copyFunction() {
             navigator.clipboard.writeText(toEditor.getValue());
        }
    </script>


    <script>
        var fromEditorElement = document.querySelector('.converter-left .editor');
        var toEditorElement = document.querySelector('.converter-right .editor');

        var fromEditor = CodeMirror(fromEditorElement, {
            value: "",
            mode: "vb",
            lineNumbers: true,

        });

        var toEditor = CodeMirror(toEditorElement, {
            mode: "javascript",
            lineNumbers: true,
        });
    </script>
    <script>
        function sendData() {
            var inputData = fromEditor.getValue();
            console.log('Ответ от бэкенда:', inputData);
            var formData = new FormData();
            formData.append('inputData', inputData);

            fetch('/api/convert', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                toEditor.setValue(data.data);
            })
            .catch(error => {
                console.error('Ошибка при отправке данных:', error);
            });
        }
    </script>
</body>
</html>

